# 8x02 - Exploit Development

从发现漏洞到实现利用的跨越。

本章聚焦“利用链评估与可利用性分析”，目标是把漏洞从“能崩”推进到“可定级、可验证修复、可解释影响面”。具体攻击细节与可直接复用的利用步骤不在本笔记范围内。

## 1. 利用链抽象（通用模型）

一条漏洞链通常包含：

- **触发**：输入如何到达 bug
- **原语**：bug 能提供什么能力（信息泄露、越界读写、UAF 等）
- **对抗缓解**：ASLR/CFI/MTE/SELinux/seccomp/进程拆分如何影响链路
- **影响达成**：越权、信息泄露、持久化、DoS 等

这个模型可以同时用于用户态与内核态。

## 2. 用户态可利用性评估

### 2.1 关注点

- 是否存在稳定的信息泄露（影响 ASLR、对象地址推断）
- 是否存在稳定的写原语（决定影响面上限）
- 目标进程的权限与隔离（应用进程 vs 系统进程；SELinux domain）

### 2.2 与现代缓解的关系

- **ASLR**：提高地址预测成本，信息泄露会削弱其效果
- **CFI/SCS/PAC**：提升控制流劫持成本，使“数据流影响”成为更常见的评估方向
- **MTE/堆硬化**：使内存破坏更易被检测并终止，降低利用稳定性

## 3. 内核态可利用性评估

内核态的关键差异在于：攻击面更依赖设备与驱动实现，且缓解机制与配置差异更大。

### 3.1 关注点

- 触发是否可由低权限稳定达成（入口：syscall/ioctl/netlink 等）
- 原语强度与可重复性
- 是否被 seccomp/SELinux/进程拆分显著限制

### 3.2 输出形式

更可复用的输出往往是：

- 可利用性分级（高/中/低）与理由
- 被哪个缓解机制阻断（或未阻断）的证据
- 修复验证（补丁前后行为变化）

## 4. 复现与修复验证

### 4.1 复现最小化

- 固定输入与环境
- 缩小到最小触发路径
- 记录可重复证据（日志、堆栈、状态差异）

### 4.2 验证补丁

- 补丁前：可稳定触发
- 补丁后：触发路径被修复或被硬化拦截
- 回归检查：正常功能路径不受影响

## 5. 关联阅读

- `/notes/android/05-kernel/04-mitigations`
- `/notes/android/04-native/01-bionic-libc`
- `/notes/android/08-practical/01-methodology`

## 参考（AOSP）
- https://source.android.com/docs/security/overview/kernel-security — 内核侧安全机制与加固方向入口（用于对照“链路被哪层阻断”）。
- https://source.android.com/docs/security/app-sandbox — 应用沙盒与纵深防御（seccomp/SELinux 等）官方入口。
- https://source.android.com/docs/security/features/selinux — Android SELinux 的官方总览入口（域/策略/版本演进）。
